openapi: 3.0.3
info:
  title: Volunteer & Donor Management API
  version: 1.0.0
  description: API contract for Volunteers, Donors, Staff, Finance, and Admin operations.

servers:
  - url: http://localhost:3000/api/v1

paths:
  # Volunteer APIs (Sample APIs - Update accordingly)
  /volunteers:
    post:
      summary: Create Volunteer Profile
      tags: [Volunteer]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Volunteer'
      responses:
        '201':
          description: Volunteer profile successfully created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
    patch:
      summary: Update Volunteer Profile
      tags: [Volunteer]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Volunteer'
      responses:
        '200':
          description: Volunteer profile updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /volunteers/{id}/documents:
    post:
      summary: Submit Volunteer Document
      tags: [Volunteer]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VolunteerDocument'
      responses:
        '201':
          description: Document submitted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VolunteerDocumentResponse'

  /volunteers/{id}/registration:
    post:
      summary: Submit Volunteer Registration Form
      tags: [Volunteer]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Volunteer'
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /projects/{project_id}/rsvp:
    post:
      summary: RSVP for Project
      tags: [Volunteer]
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RSVP'
      responses:
        '201':
          description: RSVP submitted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # Donor APIs (Sample APIs - Update accordingly)
  /donors:
    get:
      summary: Query Donor Information
      tags: [Donor]
      parameters:
        - name: search
          in: query
          description: Search term for donor name, email, or other fields
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Donor data retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Donor'
    post:
      summary: Create Donor Profile
      tags: [Donor]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Donor'
      responses:
        '201':
          description: Donor profile created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
    patch:
      summary: Update Donor Profile
      tags: [Donor]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Donor'
      responses:
        '200':
          description: Donor profile updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /donors/{id}/payment-options:
    post:
      summary: Save One-Click Payment Option
      tags: [Donor]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                payment_method:
                  type: string
      responses:
        '201':
          description: Payment option saved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /donors/{id}/wishlist:
    post:
      summary: Request More Donation Modes
      tags: [Donor]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                mode:
                  type: string
      responses:
        '201':
          description: Wishlist submitted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /donations:
    post:
      summary: Make Donation
      tags: [Donor]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Donation'
      responses:
        '201':
          description: Donation recorded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DonationResponse'

  /donations/{id}/send-receipt:
    post:
      summary: Send Receipt Email
      tags: [Donor]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Receipt sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /donations/{id}/send-thank-you:
    post:
      summary: Send Thank-You Email
      tags: [Donor]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Thank-you email sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /donors/{id}/reminders:
    post:
      summary: Send Reminder
      tags: [Donor]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Reminder sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # Finance APIs
  /finance/budgets:
    get:
      summary: Get Financial Overview
      tags: [Finance]
      description: Retrieve financial overview with fiscal year, committed, and disbursed amounts
      responses:
        '200':
          description: Financial overview retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FinancialOverview'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /finance/projects/{projectId}/budgets:
    get:
      summary: Get Project Budget Summaries
      tags: [Finance]
      description: Retrieve budget summaries for a specific project
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
      responses:
        '200':
          description: Budget summaries retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetSummaries'
        '404':
          description: Budget data not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /finance/projects/{projectId}/transactions:
    get:
      summary: Get Project Transactions
      tags: [Finance]
      description: Retrieve all transactions for a specific project
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
      responses:
        '200':
          description: Transactions retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Transaction'
        '404':
          description: Transaction data not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /finance/projects/{projectId}/commitment:
    post:
      summary: Create Commitment
      tags: [Finance]
      description: Create a new financial commitment for a project
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCommitment'
      responses:
        '201':
          description: Commitment created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  data:
                    $ref: '#/components/schemas/Commitment'
                  message:
                    type: string
                    example: Commitment created successfully
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /finance/projects/{projectId}/commitment/{id}:
    patch:
      summary: Update Commitment Status
      tags: [Finance]
      description: Update the status of an existing commitment
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Commitment ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
      responses:
        '204':
          description: Commitment status updated successfully
        '404':
          description: Commitment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete Commitment
      tags: [Finance]
      description: Delete an existing commitment
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Commitment ID
      responses:
        '204':
          description: Commitment deleted successfully
        '404':
          description: Commitment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /finance/projects/{projectId}/disbursement:
    post:
      summary: Create Disbursement
      tags: [Finance]
      description: Create a new financial disbursement for a project
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDisbursement'
      responses:
        '201':
          description: Disbursement created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  data:
                    $ref: '#/components/schemas/Disbursement'
                  message:
                    type: string
                    example: Disbursement created successfully
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /finance/projects/{projectId}/disbursement/{id}:
    patch:
      summary: Update Disbursement Status
      tags: [Finance]
      description: Update the status of an existing disbursement
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Disbursement ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
      responses:
        '204':
          description: Disbursement status updated successfully
        '404':
          description: Disbursement not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete Disbursement
      tags: [Finance]
      description: Delete an existing disbursement
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Project ID
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Disbursement ID
      responses:
        '204':
          description: Disbursement deleted successfully
        '404':
          description: Disbursement not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Volunteer Manager APIs (Sample APIs - Update accordingly)
  /volunteers/pending:
    get:
      summary: View Pending Volunteers
      tags: [VolunteerManager]
      responses:
        '200':
          description: Pending volunteers list

  /volunteers/{id}/approve:
    patch:
      summary: Approve Volunteer
      tags: [VolunteerManager]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Volunteer approved

  # Super Admin APIs (Sample APIs - Update accordingly)
  /admin/users:
    post:
      summary: Create Admin User
      tags: [SuperAdmin]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Admin user created

  /admin/users/{id}:
    delete:
      summary: Delete Admin User
      tags: [SuperAdmin]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Admin user deleted

  /admin/logs:
    get:
      summary: Get Admin Logs
      tags: [SuperAdmin]
      responses:
        '200':
          description: Logs retrieved

  # Donation APIs (Sample APIs - Update accordingly)
  /donations/home:
    get:
      summary: Get Donation Homepage Data
      tags: [Donation]
      responses:
        "200":
          description: Donation homepage data
  /donations/projects:
    get:
      summary: Get All Donation Projects
      tags: [Donation]
      parameters:
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
      responses:
        "200":
          description: List of donation projects
  /donations/applications:
    post:
      summary: Submit Donation Application
      tags: [Donation]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "201":
          description: Donation application submitted
  /donations/partners/donations:
    get:
      summary: Get Partner's Donation History
      tags: [Donation]
      responses:
        "200":
          description: Partner's donation history
  /donations/{donationId}:
    get:
      summary: Get Donation Detail
      tags: [Donation]
      parameters:
        - name: donationId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Donation detail
  /donations/{donationId}/receipt:
    get:
      summary: Download Donation Receipt
      tags: [Donation]
      parameters:
        - name: donationId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Donation receipt

# Components (Schemas) (Sample - Update accordingly)
components:
  schemas:
    Volunteer:
      type: object
      properties:
        id: { type: string }
        full_name: { type: string }
        nric_fin: { type: string }
        passport_number: { type: string }
        contact_number: { type: string }
        occupation: { type: string }
        languages_spoken:
          type: array
          items: { type: string }
        highest_education: { type: string }
        volunteering_duration:
          { type: string, enum: [ad_hoc, long_term, short_term] }
        email: { type: string }
        address: { type: string }
        nationality: { type: string }
        gender: { type: string, enum: [male, female, other] }
        dob: { type: string, format: date }
        volunteer_interest:
          type: array
          items: { type: string }
        volunteer_expertise:
          type: object
          properties:
            is_first_time: { type: boolean }
            past_experience:
              type: array
              items: { type: string, enum: [elderly, family, children, pwids] }
            years: { type: integer, minimum: 0, maximum: 50 }
            strengths:
              type: array
              items: { type: string }
            weaknesses:
              type: array
              items: { type: string }
        availability:
          type: object
          properties:
            days:
              type: array
              items:
                {
                  type: string,
                  enum:
                    [
                      monday,
                      tuesday,
                      wednesday,
                      thursday,
                      friday,
                      saturday,
                      sunday,
                    ],
                }
            timings:
              type: array
              items: { type: string }
            specific_dates:
              type: array
              items: { type: string, format: date }
        lifetime_hours_volunteered: { type: integer }
        projects_of_interest:
          type: array
          items: { type: string }

    Donor:
      type: object
      properties:
        id: { type: string }
        full_name: { type: string }
        nric_fin: { type: string }
        email: { type: string }
        contact_number: { type: string }
        address: { type: string }
        donation_amount: { type: number }
        preferred_cause: { type: string }
        donation_type: { type: string, enum: [one_time, recurring] }
        payment_method: { type: string }
        is_tax_deductable: { type: boolean }

    VolunteerDocument:
      type: object
      properties:
        id: { type: string }
        document_type: { type: string }
        file_url: { type: string }

    VolunteerDocumentResponse:
      type: object
      properties:
        id: { type: string }
        status: { type: string, enum: [pending, approved, rejected] }

    RSVP:
      type: object
      properties:
        volunteer_id: { type: string }
        status: { type: string, enum: [yes, no, maybe] }

    Donation:
      type: object
      properties:
        donor_id: { type: string }
        amount: { type: number }
        type:
          { type: string, enum: [individual, corporate, fundraising events] }
        payment_method: { type: string }
        project_id: { type: string }
        date: { type: string }

    DonationResponse:
      type: object
      properties:
        id: { type: string }
        status: { type: string, enum: [confirmed, pending, failed] }
        receipt_url: { type: string }

    Attendance:
      type: object
      properties:
        volunteer_id: { type: string }
        project_id: { type: string }
        status: { type: string, enum: [present, absent] }
        date: { type: string, format: date }

    SuccessResponse:
      type: object
      properties:
        id: { type: string }
        message: { type: string }

    ErrorResponse:
      type: object
      properties:
        error_code: { type: string }
        message: { type: string }
        details: { type: string }

    FinancialOverview:
      type: object
      properties:
        fiscalYear:
          type: integer
          example: 2025
        committed:
          type: number
          format: double
          example: 150000.00
        disbursed:
          type: number
          format: double
          example: 75000.00

    BudgetSummaries:
      type: object
      properties:
        projectId:
          type: string
          format: uuid
        fiscalYear:
          type: integer
        totalCommitted:
          type: number
          format: double
        totalDisbursed:
          type: number
          format: double

    Transaction:
      type: object
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        amount:
          type: number
          format: double
        description:
          type: string
        fiscalYear:
          type: integer
        status:
          type: string
          enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
        type:
          type: string
          enum: [COMMITMENT, DISBURSEMENT]
        createdAt:
          type: string
          format: date-time
        createdById:
          type: string
          format: uuid

    CreateCommitment:
      type: object
      required:
        - amount
        - fiscalYear
        - status
        - createdById
      properties:
        amount:
          type: number
          format: double
          minimum: 0.01
          example: 50000.00
        description:
          type: string
          example: 'Q1 budget allocation for community outreach'
        fiscalYear:
          type: integer
          minimum: 1900
          example: 2025
        status:
          type: string
          enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
          example: DRAFT
        createdById:
          type: string
          format: uuid
          example: '123e4567-e89b-12d3-a456-426614174000'
        approvedById:
          type: string
          format: uuid
        approvedAt:
          type: string
          format: date-time

    Commitment:
      type: object
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        amount:
          type: number
          format: double
        description:
          type: string
        fiscalYear:
          type: integer
        status:
          type: string
          enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
        createdById:
          type: string
          format: uuid
        approvedById:
          type: string
          format: uuid
        approvedAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateDisbursement:
      type: object
      required:
        - amount
        - fiscalYear
        - status
        - createdById
      properties:
        amount:
          type: number
          format: double
          minimum: 0.01
          example: 25000.00
        description:
          type: string
          example: 'Payment for facility rental'
        fiscalYear:
          type: integer
          minimum: 1900
          example: 2025
        status:
          type: string
          enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
          example: DRAFT
        createdById:
          type: string
          format: uuid
          example: '123e4567-e89b-12d3-a456-426614174000'
        approvedById:
          type: string
          format: uuid
        approvedAt:
          type: string
          format: date-time
        disbursedAt:
          type: string
          format: date-time

    Disbursement:
      type: object
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        amount:
          type: number
          format: double
        description:
          type: string
        fiscalYear:
          type: integer
        status:
          type: string
          enum: [DRAFT, PENDING, APPROVAL, RELEASED, REJECTED]
        createdById:
          type: string
          format: uuid
        approvedById:
          type: string
          format: uuid
        approvedAt:
          type: string
          format: date-time
        disbursedAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
